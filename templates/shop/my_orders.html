{% extends 'student_base.html' %}
{% load static %}
{% block title %}My Orders{% endblock %}
{% block content %}
<div class="container py-4">
  <h3>My Orders</h3>
  <div class="table-responsive mt-3">
    <table class="table">
      <thead><tr><th>Product</th><th>Amount</th><th>Payment</th><th>Status</th><th>Delivery</th><th></th></tr></thead>
      <tbody>
        {% for o in orders %}
        <tr>
          <td>{{ o.product.title }}</td>
          <td>â‚¹{{ o.amount }}</td>
          <td>{{ o.get_payment_method_display }}</td>
          <td>{{ o.get_status_display }}</td>
          <td>{% if o.delivery_date %}{{ o.delivery_date }}{% else %}-{% endif %}</td>
          <td>
            {% if o.status == 'DELIVERED' %}
              {% if o.product.id in reviewed_ids %}
                <span class="badge bg-success">Reviewed</span>
              {% else %}
                <a href="{% url 'shop_order_add_review' o.id %}" class="btn btn-sm btn-outline-primary">Add Review</a>
              {% endif %}
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="6" class="text-center text-muted">No orders yet</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
