{% extends 'student_base.html' %}
{% load static %}
{% block title %}Elitte Shop{% endblock %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Elitte Shop</h3>
    <div>
      <a href="{% url 'shop_cart' %}" class="btn btn-outline-secondary me-2 position-relative">
        <i class="fas fa-shopping-cart"></i> Cart
        {% if cart_count and cart_count > 0 %}
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">{{ cart_count }}</span>
        {% endif %}
      </a>
      <a href="{% url 'shop_my_orders' %}" class="btn btn-outline-primary"><i class="fas fa-box"></i> My Orders</a>
      <a href="{% url 'shop_my_shop' %}" class="btn btn-outline-primary position-relative">
        <i class="fas fa-box"></i> My Shop
        {% if seller_pending_count and seller_pending_count > 0 %}
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">{{ seller_pending_count }}</span>
        {% endif %}
      </a>
      
  
    </div>
  </div>

  <form method="get" class="row g-2 mb-3">
    <div class="col-md-4">
      <input type="text" name="q" value="{{ q }}" class="form-control" placeholder="Search products...">
    </div>
    <div class="col-md-3">
      <select name="category" class="form-select">
        <option value="">All Categories</option>
        {% for c in categories %}
        <option value="{{ c.id }}" {% if c.id|stringformat:'s' == cat %}selected{% endif %}>{{ c.name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-2"><input type="number" class="form-control" name="min" value="{{ min }}" placeholder="Min price"></div>
    <div class="col-md-2"><input type="number" class="form-control" name="max" value="{{ max }}" placeholder="Max price"></div>
    <div class="col-md-1"><button class="btn btn-primary w-100">Go</button></div>
  </form>

  <div class="row g-3">
    {% for p in items %}
    <div class="col-md-3">
      <div class="card h-100">
        {% if p.default_image %}
        <img src="{{ p.default_image.url }}" class="card-img-top" style="height:180px;object-fit:cover;">
        {% endif %}
        <div class="card-body">
          <h6 class="card-title mb-1">{{ p.title }}</h6>
          <div class="text-muted small mb-2">â‚¹{{ p.price }}</div>
          <div class="text-warning"><i class="fas fa-star"></i> {{ p.average_rating }}</div>
          <a href="{% url 'shop_product_detail' p.id %}" class="stretched-link"></a>
        </div>
      </div>
    </div>
    {% empty %}
    <div class="col-12 text-center text-muted py-5">No products found.</div>
    {% endfor %}
  </div>
</div>
{% endblock %}
