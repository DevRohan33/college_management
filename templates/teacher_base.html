{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Teacher Dashboard{% endblock %}</title>

    <!-- Bootstrap & FontAwesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'css/teacher_base.css' %}">

    {% block extra_css %}{% endblock %}
</head>
<body>
<!-- Mobile menu toggle -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Theme toggle -->
    <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </button>

    <!-- Sidebar overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <div class="main-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
            <a class="navbar-brand d-flex align-items-center" href="/">
                <img src="{% static 'index/logo.png' %}" alt="Logo" class="logo me-2">
                <span class="brand-text">ECE</span>
            </a>
        </div>
            <ul class="sidebar-menu">
                <li><a href="/" class="{% if request.resolver_match.url_name == 'teacher_dashboard' %}active{% endif %}">
                    <i class="fas fa-tachometer-alt icon"></i> Dashboard</a></li>
                <li><a href="{% url 'teacher_profile' %}" class="{% if request.resolver_match.url_name == 'teacher_profile' %}active{% endif %}">
                    <i class="fas fa-user icon"></i> My Profile</a></li>
                <li><a href="{% url 'teacher_classes' %}" class="{% if request.resolver_match.url_name == 'teacher_classes' %}active{% endif %}">
                    <i class="fas fa-chalkboard-user icon"></i> My Classes</a></li>
                <li><a href="{% url 'take_attendance' %}" class="{% if request.resolver_match.url_name == 'take_attendance' %}active{% endif %}">
                    <i class="fas fa-user-check icon"></i> Attendance</a></li>
                <li><a href="{% url 'assignment_list' %}" class="{% if request.resolver_match.url_name == 'assignment_list' %}active{% endif %}">
                    <i class="fas fa-tasks icon"></i> Assignments</a></li>
                <li><a href="{% url 'teacher_grades' %}" class="{% if request.resolver_match.url_name == 'teacher_grades' %}active{% endif %}">
                    <i class="fas fa-chart-bar icon"></i> Grades</a></li>
                <li><a href="{% url 'teacher_students' %}" class="{% if request.resolver_match.url_name == 'teacher_students' %}active{% endif %}">
                    <i class="fas fa-users icon"></i> Students</a></li>
                <li><a href="{% url 'notice_create' %}" class="{% if request.resolver_match.url_name == 'notice_create' %}active{% endif %}">
                    <i class="fas fa-bullhorn icon"></i> Notice Board</a></li>
                
                <hr class="menu-divider">
                
                <li><a href="#">
                    <i class="fas fa-calendar-alt icon"></i> Schedule</a></li>
                <li><a href="#">
                    <i class="fas fa-question-circle icon"></i> Help & Support</a></li>
                <li><a href="{% url 'logout' %}">
                    <i class="fas fa-sign-out-alt icon"></i> Logout</a></li>
            </ul>
        </div>

        <!-- Page Content -->
        <main class="main-content">
            <!-- Header Section -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h1 class="header-title">{% block page_title %}Teacher Dashboard{% endblock %}</h1>
                    <p class="header-subtitle">Welcome back, {{ user.first_name|default:user.username }}! Ready to inspire minds today?</p>
                </div>
                <div class="d-flex align-items-center">
                    <div class="me-3 text-end">
                        <div class="fw-bold">{{ user.first_name }} {{ user.last_name }}</div>
                        <small class="text-muted">Teacher ID: TCH-{{ user.id }}</small>
                    </div>
                    <img src="{{ user.teacher_profile.profile_image.url }}" class="rounded-circle" alt="User Avatar" width="50" height="50">
                </div>
            </div>

            <!-- Django messages -->
            {% if messages %}
              <div class="container-fluid mb-4">
                {% for message in messages %}
                  <div class="alert alert-{{ message.tags }} alert-dismissible fade show animate-fade-in-up" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                  </div>
                {% endfor %}
              </div>
            {% endif %}

            {% block content %}{% endblock %}
    </main>

</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Mobile menu functionality
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.getElementById('sidebarOverlay');
    const themeToggle = document.getElementById('themeToggle');

    // Mobile menu toggle
    mobileMenuToggle.addEventListener('click', () => {
        sidebar.classList.toggle('active');
        sidebarOverlay.classList.toggle('active');
    });

    // Close sidebar when clicking overlay
    sidebarOverlay.addEventListener('click', () => {
        sidebar.classList.remove('active');
        sidebarOverlay.classList.remove('active');
    });

    // Theme toggle functionality
    themeToggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        
        const icon = themeToggle.querySelector('i');
        icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
    });

    // Load saved theme
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    const themeIcon = themeToggle.querySelector('i');
    themeIcon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';

    // Close mobile menu when resizing to desktop
    window.addEventListener('resize', () => {
        if (window.innerWidth > 768) {
            sidebar.classList.remove('active');
            sidebarOverlay.classList.remove('active');
        }
    });

    // Add loading states for links
    document.querySelectorAll('.sidebar-menu a').forEach(link => {
        link.addEventListener('click', function() {
            if (!this.classList.contains('active')) {
                const icon = this.querySelector('i');
                const originalClass = icon.className;
                icon.className = 'fas fa-spinner fa-spin icon';
                
                setTimeout(() => {
                    icon.className = originalClass;
                }, 1000);
            }
        });
    });

    // Animate cards on load
    document.addEventListener('DOMContentLoaded', () => {
        const cards = document.querySelectorAll('.card');
        cards.forEach((card, index) => {
            card.classList.add('animate-fade-in-up');
            card.style.animationDelay = `${index * 0.1}s`;
        });
    });

    // Add smooth scroll behavior
    document.documentElement.style.scrollBehavior = 'smooth';

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
</script>

{% block extra_js %}{% endblock %}
{% include 'includes/chatbot.html' %}

</body>
</html>